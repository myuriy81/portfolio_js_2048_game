var t={};class e{static gameStatus={idle:"idle",playing:"playing",win:"win",lose:"lose"};constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.initialState=t,this.state=this.initialState.map(t=>[...t]),this.status=e.gameStatus.idle,this.score=0}moveLeft(){if(this.getStatus()!==e.gameStatus.playing)return;let t=!1,s=this.state.map(e=>{let s=e.filter(t=>0!==t),a=[];for(let e=0;e<s.length;e++)if(s[e]===s[e+1]){let i=2*s[e];a.push(i),this.score+=i,e++,t=!0}else a.push(s[e]);for(;a.length<e.length;)a.push(0);return t||e.every((t,e)=>t===a[e])||(t=!0),a});return t&&(this.state=s,this.addCell(),this.setState(),this.checkStatus()),t}moveRight(){if(this.getStatus()!==e.gameStatus.playing)return;let t=!1,s=this.state.map(e=>{let s=e.filter(t=>0!==t),a=[];for(let e=s.length-1;e>=0;e--)if(s[e]===s[e-1]){let i=2*s[e];a.unshift(i),this.score+=i,e--,t=!0}else a.unshift(s[e]);for(;a.length<e.length;)a.unshift(0);return t||e.every((t,e)=>t===a[e])||(t=!0),a});return t&&(this.state=s,this.addCell(),this.setState(),this.checkStatus()),t}moveUp(){if(this.getStatus()!==e.gameStatus.playing)return;let t=!1,s=this.state.map(t=>[...t]);for(let e=0;e<this.state[0].length;e++){let a=[];for(let t=0;t<this.state.length;t++)0!==this.state[t][e]&&a.push(this.state[t][e]);let i=[];for(let e=0;e<a.length;e++)if(a[e]===a[e+1]){let s=2*a[e];i.push(s),this.score+=s,e++,t=!0}else i.push(a[e]);for(;i.length<this.state.length;)i.push(0);for(let a=0;a<this.state.length;a++)s[a][e]!==i[a]&&(s[a][e]=i[a],t=!0)}return t&&(this.state=s,this.addCell(),this.setState(),this.checkStatus()),t}moveDown(){if(this.getStatus()!==e.gameStatus.playing)return;let t=!1,s=this.state.map(t=>[...t]);for(let e=0;e<this.state[0].length;e++){let a=[];for(let t=this.state.length-1;t>=0;t--)0!==this.state[t][e]&&a.push(this.state[t][e]);let i=[];for(let e=0;e<a.length;e++)if(a[e]===a[e+1]){let s=2*a[e];i.unshift(s),this.score+=s,e++,t=!0}else i.unshift(a[e]);for(;i.length<this.state.length;)i.unshift(0);for(let a=0;a<this.state.length;a++)s[a][e]!==i[a]&&(s[a][e]=i[a],t=!0)}return t&&(this.state=s,this.addCell(),this.setState(),this.checkStatus()),t}getState(){return this.state}getScore(){return this.score}getStatus(){return this.status}start(){this.status=e.gameStatus.playing,this.state=this.initialState.map(t=>[...t]),this.addCell(),this.addCell(),this.setState()}restart(){this.score=0,this.status=e.gameStatus.idle,this.state=this.initialState.map(t=>[...t]),this.setState()}addCell(){let t=[];for(let e=0;e<this.state.length;e++)for(let s=0;s<this.state[e].length;s++)0===this.state[e][s]&&t.push({y:e,x:s});if(0===t.length)return;let e=this.addRandomNumber(t.length),{y:s,x:a}=t[e],i=this.state.map(t=>[...t]);i[s][a]=this.getRandomCell(),this.state=i}setState(){let t=document.querySelectorAll(".field-cell"),e=this.state.flat();if(0!==t.length)for(let s=0;s<e.length;s++){let a=t[s],i=e[s];a&&(a.className="field-cell",i>0?(a.textContent=i,a.classList.add(`field-cell--${i}`)):a.textContent="")}}addRandomNumber(t){return Math.floor(Math.random()*t)}getRandomCell(){return .9>Math.random()?2:4}checkStatus(){let t=!1,s=!1;for(let t=0;t<this.state.length;t++)for(let s=0;s<this.state[t].length;s++)if(2048===this.state[t][s]){this.status=e.gameStatus.win;return}for(let t=0;t<this.state.length;t++){for(let e=0;e<this.state[t].length-1;e++)if(this.state[t][e]===this.state[t][e+1]){s=!0;break}if(s)break}if(!s)for(let t=0;t<this.state.length-1;t++){for(let e=0;e<this.state[t].length;e++)if(this.state[t][e]===this.state[t+1][e]){s=!0;break}if(s)break}for(let e=0;e<this.state.length;e++){for(let s=0;s<this.state[e].length;s++)if(0===this.state[e][s]){t=!0;break}if(t)break}t||s||(this.status=e.gameStatus.lose)}}const s=new(t=e),a=document.querySelector(".start"),i=document.querySelector(".message-start"),l=document.querySelector(".message-lose"),h=document.querySelectorAll(".message-win"),r=document.querySelector(".game-score");a.addEventListener("click",()=>{a.classList.contains("start")?(s.start(),a.classList="button restart",a.innerHTML="Restart",i.classList.add("hidden")):a.classList.contains("restart")&&(s.restart(),r.innerHTML=s.getScore(),a.classList="button start",a.innerHTML="Start",i.classList.remove("hidden"),l.classList.add("hidden"),h.classList.add("hidden"))}),document.addEventListener("keydown",e=>{if(e.preventDefault(),"playing"!==s.getStatus())return;let a={ArrowUp:s.moveUp,ArrowDown:s.moveDown,ArrowLeft:s.moveLeft,ArrowRight:s.moveRight}[e.key];a&&a.call(s),r.innerHTML=s.getScore(),s.getStatus()===t.gameStatus.lose?l.classList.remove("hidden"):s.getStatus()===t.gameStatus.win&&h.classList.remove("hidden")});
//# sourceMappingURL=index.75518d62.js.map
